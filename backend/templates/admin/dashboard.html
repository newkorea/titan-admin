<%inherit file="admin_frame.html"/>

<%block name="title">시작하기</%block>
<%block name="subtitle">타이탄 관리자 사이트에 오신걸 환영합니다</%block>

<%block name="css"></%block>

<%block name="content">
<div class="row">
  <div class="col-12">
    <div class="card">
      <div class="card-body">
        <div>안녕하세요. 관리자 대시보드입니다.</div>
        <div>최근 무통장 결제 현황을 요약해서 보여드립니다.</div>
      </div>
    </div>
  </div>
</div>

<div class="row">
  <!-- 요청 대기 -->
  <div class="col-md-4">
    <div class="card">
      <div class="card-header"><b>요청 대기 (최근 10건)</b></div>
      <div class="card-body p-2">
        <ul class="list-group list-group-flush">
          % for r in (list_pending or []):
          <li class="list-group-item d-flex justify-content-between align-items-center">
            <div>
              <div><b>${r['username'] or r['email']}</b></div>
              <small>${r['product_name']} / ${r['dt']}</small>
            </div>
            <div><span class="badge badge-secondary">${r['krw']}</span></div>
          </li>
          % endfor
          % if not list_pending:
          <li class="list-group-item">데이터가 없습니다</li>
          % endif
        </ul>
      </div>
    </div>
  </div>

  <!-- 승인 완료 -->
  <div class="col-md-4">
    <div class="card">
      <div class="card-header"><b>승인 완료 (최근 10건)</b></div>
      <div class="card-body p-2">
        <ul class="list-group list-group-flush">
          % for r in (list_approved or []):
          <li class="list-group-item d-flex justify-content-between align-items-center">
            <div>
              <div><b>${r['username'] or r['email']}</b></div>
              <small>${r['product_name']} / ${r['dt']}</small>
            </div>
            <div><span class="badge badge-success">${r['krw']}</span></div>
          </li>
          % endfor
          % if not list_approved:
          <li class="list-group-item">데이터가 없습니다</li>
          % endif
        </ul>
      </div>
    </div>
  </div>

  <!-- 취소/환불 -->
  <div class="col-md-4">
    <div class="card">
      <div class="card-header"><b>취소/환불 (최근 10건)</b></div>
      <div class="card-body p-2">
        <ul class="list-group list-group-flush">
          % for r in (list_canceled or []):
          <li class="list-group-item d-flex justify-content-between align-items-center">
            <div>
              <div><b>${r['username'] or r['email']}</b></div>
              <small>${r['product_name']} / ${r['dt']}</small>
            </div>
            <div><span class="badge badge-danger">${r['krw']}</span></div>
          </li>
          % endfor
          % if not list_canceled:
          <li class="list-group-item">데이터가 없습니다</li>
          % endif
        </ul>
      </div>
    </div>
  </div>
</div>

<!-- 최근 24시간 Top 10 통계 -->
<div class="row mt-3">
  <!-- 로그인 시도 Top 10 -->
  <div class="col-md-4">
    <div class="card">
      <div class="card-header"><b>최근 24시간 로그인 시도 Top 10</b></div>
      <div class="card-body p-0">
        <table class="table table-sm mb-0">
          <thead>
            <tr>
              <th style="width: 50px;">순위</th>
              <th>이메일</th>
              <th style="width: 90px;" class="text-right">건수</th>
            </tr>
          </thead>
          <tbody>
            % for i, r in enumerate(top_login_24h or [], start=1):
            <tr>
              <td>${i}</td>
              <td>${r['email']}</td>
              <td class="text-right">${r['cnt']}</td>
            </tr>
            % endfor
            % if not top_login_24h:
            <tr><td colspan="3" class="text-center">데이터가 없습니다</td></tr>
            % endif
          </tbody>
        </table>
      </div>
    </div>
  </div>

  <!-- 서버 접속 실패 Top 10 -->
  <div class="col-md-4">
    <div class="card">
      <div class="card-header"><b>최근 24시간 서버 접속 실패 Top 10</b></div>
      <div class="card-body p-0">
        <table class="table table-sm mb-0">
          <thead>
            <tr>
              <th style="width: 50px;">순위</th>
              <th>이메일</th>
              <th style="width: 90px;" class="text-right">건수</th>
            </tr>
          </thead>
          <tbody>
            % for i, r in enumerate(top_failed_24h or [], start=1):
            <tr>
              <td>${i}</td>
              <td>${r['email']}</td>
              <td class="text-right">${r['cnt']}</td>
            </tr>
            % endfor
            % if not top_failed_24h:
            <tr><td colspan="3" class="text-center">데이터가 없습니다</td></tr>
            % endif
          </tbody>
        </table>
      </div>
    </div>
  </div>

  <!-- 강제 종료 Top 10 -->
  <div class="col-md-4">
    <div class="card">
      <div class="card-header"><b>최근 24시간 강제 종료 Top 10</b></div>
      <div class="card-body p-0">
        <table class="table table-sm mb-0">
          <thead>
            <tr>
              <th style="width: 50px;">순위</th>
              <th>이메일</th>
              <th style="width: 90px;" class="text-right">건수</th>
            </tr>
          </thead>
          <tbody>
            % for i, r in enumerate(top_force_24h or [], start=1):
            <tr>
              <td>${i}</td>
              <td>${r['email']}</td>
              <td class="text-right">${r['cnt']}</td>
            </tr>
            % endfor
            % if not top_force_24h:
            <tr><td colspan="3" class="text-center">데이터가 없습니다</td></tr>
            % endif
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>
</%block>

<%block name="js">
</%block>
